apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: {{ .Values.hpa.name }}                  # ğŸ“ Name of the HorizontalPodAutoscaler defined in values.yaml
spec:
  scaleTargetRef:
    apiVersion: apps/v1                         # ğŸ“Š API version of the target resource
    kind: Deployment                            # ğŸš€ Kind of the target resource
    name: {{ .Values.deploymentname }}          # ğŸ·ï¸ Name of the target Deployment
  minReplicas: {{ .Values.hpa.minReplicas }}    # ğŸ“‰ Minimum number of replicas for the target resource
  maxReplicas: {{ .Values.hpa.maxReplicas }}    # ğŸ“ˆ Maximum number of replicas for the target resource
  metrics:
  - type: Resource                              # ğŸ’¡ Type of metric used for autoscaling
    resource:
      name: cpu                                 # ğŸ–¥ï¸ Name of the resource metric (cpu, memory)
      target:
        type: Utilization                        # ğŸ“Š Type of target metric value
        averageUtilization: {{ .Values.hpa.targetCPUUtilization }}  # ğŸ¯ Target average CPU utilization percentage
