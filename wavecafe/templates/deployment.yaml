apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ .Values.deploymentname }}  # ğŸš€ Name of the deployment defined in values.yaml
spec:
  # replicas: 1   # Number of desired replicas for the deployment
  selector:
    matchLabels:
      app: {{ .Values.appname }}     # ğŸ·ï¸ Label selector to match pods belonging to this deployment
  template:
    metadata:
      labels:
        app: {{ .Values.appname }}   # ğŸ·ï¸ Label applied to pods created by this deployment
    spec:
      containers:
        - name: my-app-container
          image: "{{ .Values.image.name }}:{{ .Values.image.tag }}"  # ğŸ³ Docker image to use for the container
          ports:
            - name: cafe-port
              containerPort: 80     # ğŸŒ Port exposed by the container
              
          resources:                 # ğŸ’¡ Resource allocation for the container
            requests:                # ğŸ’¼ Resource requests (minimum required by the container)
              cpu: "100m"            # Request 100 milliCPU (1/10th of a CPU core). Adjust based on observed CPU usage  
            limits:                  # ğŸ’¡ Resource limits (maximum allowed by the container)
              cpu: "500m"            # Limit CPU usage to 500 milliCPU (1/2 of a CPU core). Adjust based on observed CPU usage  
              
          livenessProbe:             # ğŸ” Probe to determine if the container is alive
            exec:
              command:
                - ls                 # Execute the 'ls' command
            initialDelaySeconds: 15  # Delay before the first probe is performed
            periodSeconds: 20        # Interval between consecutive probes
          readinessProbe:            # ğŸ” Probe to determine if the container is ready to serve traffic
            exec:
              command:
                - ls                 # Execute the 'ls' command
            initialDelaySeconds: 10  # Delay before the first probe is performed
            periodSeconds: 15        # Interval between consecutive probes
